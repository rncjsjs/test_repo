# Android
# Build your Android project with Gradle.
# Add steps that test, sign, and distribute the APK, save build artifacts, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/android

trigger:
- master

pool:
  vmImage: 'macos-latest'

steps:
- task: Gradle@2
  inputs:
    workingDirectory: 'Test01'
    gradleWrapperFile: 'Test01/gradlew'
    gradleOptions: '-Xmx3072m'
    publishJUnitResults: false
    testResultsFiles: '**/TEST-*.xml'
    tasks: 'assembleDebug'

- task: UnityBuildTask@3
  inputs:
    buildTarget: 'Android'
    unityProjectPath: 'test01'
    outputPath: 'test01'
    outputFileName: '**.apk'

- task: CmdLine@2
  inputs:
    script: |
      $project = “test01”
      $arguments = @(
      “-quit”,
      “-batchmode”,
      “-projectPath $project”,
      “-executeMethod Autobuild.BuildGame”
      “-username $(unityusername)”,
      “-password $(unitypassword)”
      )
